---
title: "Table S1. Strains selected for the GWAS panel"
format: html
---

```{r}
#| include: false
library(tidyverse)
library(dplyr)
library(data.table)
```

```{r}
# source the helper functions
source(file.path("bin", "general.R"))

source(file.path("bin", "outs.R"))
source(file.path("bin", "materials_key.R"))
```

```{r}
# get the list of strains in the GWAS
load(file.path("data", "processed", "phenotypes", "pheno.df.rda"))

# Read the strain means data
strains <- unique(pheno.df$strain)

# downlaod latest data from CeaNDR
ce_iso_loc <- data.table::fread("https://caendr.org/request-strains/download/c-elegans/20220216/strain-data/csv")

# Three strains have non-CaeNDR strain names in data,  c("CB4855" "CB4857" "PB306")
# these are c("ECA248" = "CB4855, ECA250 = "CB4857", "ECA259" = "PB306")
strains[!strains %in% ce_iso_loc$strain]
fix <- c("ECA248" = "CB4855", "ECA250" = "CB4857", "ECA259" = "PB306")

# make the table
tableS1 <- ce_iso_loc %>%
  dplyr::filter(strain %in% names(fix) | strain %in% strains) %>%
  dplyr::select(-1:-3, strain = isotype, caendr_release = release, -strain_set:-sequenced)

# # save the table
# rio::export(tableS1, file = "tables/tableS1.csv")

save_supp_table_csv(tableS1, "strain_table")
```

```{r}
#| label: tbl-strain-info
#| echo: false

tableS1
```
